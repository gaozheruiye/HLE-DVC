import mcl
from mcl import *
import mcl.hook

BN254 = 0
BLS12_381 = 5
MCLBN_FR_UNIT_SIZE = 4
MCLBN_FP_UNIT_SIZE = 6

FP_SIZE = MCLBN_FP_UNIT_SIZE
FR_SIZE = MCLBN_FR_UNIT_SIZE + 2
G1_SIZE = MCLBN_FP_UNIT_SIZE * 3
G2_SIZE = MCLBN_FP_UNIT_SIZE * 6
GT_SIZE = MCLBN_FP_UNIT_SIZE * 12

SEC_SIZE = FR_SIZE * 2
PUB_SIZE = G1_SIZE + G2_SIZE
G1_CIPHER_SIZE = G1_SIZE * 2
G2_CIPHER_SIZE = G2_SIZE * 2
GT_CIPHER_SIZE = GT_SIZE * 4

MCLBN_COMPILED_TIME_VAR = (MCLBN_FR_UNIT_SIZE * 10) + MCLBN_FP_UNIT_SIZE


assert mcl.hook.mcl.mclBn_init(BLS12_381, MCLBN_COMPILED_TIME_VAR)==0

G1_STR = b"1 3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507 1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569"
G2_STR = b"1 352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160 3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758 1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905 927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582"


G1 = mcl.G1()
G1.setStr(G1_STR)

G2 = mcl.G2()
G2.setStr(G2_STR)

def field_element(v):
    a=mcl.Fr()
    # a.setStr(b"349973468053005270613505437811878073801571839097274520720681634568773807721464161351143511")
    # print(str(v).encode())
    # str(v).encode()
    # print(b"9")
    a.setStr(str(v).encode())
    # a.setStr(b"9")
    return a
# pairing, add, multiply

def add(g1,g2):
    return g1 + g2

def multiply(g1,scalar):
    scalar = field_element(scalar)
    return g1 * scalar

def pairing(g,h):
    return mcl.GT.pairing(h , g)

if __name__ == "__main__":
    v = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001
    # v = 9
    # print("v:",v)
    a = field_element(v)
    print (a)
